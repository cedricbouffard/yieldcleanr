<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Filtre d'Humidité • yieldcleanr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filtre d'Humidité">
<meta name="description" content="Outils pour nettoyer les données de rendement agricole / Tools for cleaning agricultural yield data">
<style>
.lang-toggle { cursor: pointer; padding: 8px 12px; }
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const langToggle = document.getElementById('lang-toggle');
  if (langToggle) {
    langToggle.addEventListener('click', function(e) {
      e.preventDefault();
      const currentPath = window.location.pathname;
      const isEn = currentPath.includes('/en/') || currentPath.endsWith('_en.html');
      let newPath;
      if (isEn) {
        newPath = currentPath.replace('/en/', '/fr/').replace('_en.html', '_en.html');
      } else {
        newPath = currentPath.replace('/fr/', '/en/').replace('_fr.html', '_en.html');
      }
      if (newPath !== currentPath) {
        window.location.href = newPath;
      }
    });
  }
});
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">yieldcleanr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Référence</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Nouveautés</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cedricbouffard/yieldcleanr">GitHub</a></li>
<li class="nav-item"><a class="nav-link lang-toggle" id="lang-toggle" href="../#">FR | EN</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Filtre d'Humidité</h1>
            <h3 data-toc-skip class="subtitle">Détection et correction
des anomalies d’humidité</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cedricbouffard/yieldcleanr/blob/main/vignettes/filtre-humidite.Rmd" class="external-link"><code>vignettes/filtre-humidite.Rmd</code></a></small>
      <div class="d-none name"><code>filtre-humidite.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Le filtre d’humidité élimine les points avec des taux d’humidité
anormaux. L’humidité du grain est un paramètre critique qui : - Affecte
la conversion du rendement humide vers le rendement sec - Varie avec les
conditions météorologiques - Peut dériver en fin de journée ou lors des
changements de variété</p>
</div>
<div class="section level2">
<h2 id="principes-mathématiques">Principes mathématiques<a class="anchor" aria-label="anchor" href="#principes-math%C3%A9matiques"></a>
</h2>
<div class="section level3">
<h3 id="conversion-rendement-humide-sec">Conversion rendement humide → sec<a class="anchor" aria-label="anchor" href="#conversion-rendement-humide-sec"></a>
</h3>
<p>Le rendement sec est calculé à partir du rendement humide et de
l’humidité :</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>s</mi><mi>e</mi><mi>c</mi></mrow></msub><mo>=</mo><msub><mi>Y</mi><mrow><mi>h</mi><mi>u</mi><mi>m</mi><mi>i</mi><mi>d</mi><mi>e</mi></mrow></msub><mo>×</mo><mfrac><mrow><mn>100</mn><mo>−</mo><mi>H</mi></mrow><mrow><mn>100</mn><mo>−</mo><msub><mi>H</mi><mrow><mi>s</mi><mi>t</mi><mi>d</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">Y_{sec} = Y_{humide} \times \frac{100 - H}{100 - H_{std}}</annotation></semantics></math></p>
<p>Où : -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>s</mi><mi>e</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">Y_{sec}</annotation></semantics></math>
= rendement à humidité standard (kg/ha) -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>h</mi><mi>u</mi><mi>m</mi><mi>i</mi><mi>d</mi><mi>e</mi></mrow></msub><annotation encoding="application/x-tex">Y_{humide}</annotation></semantics></math>
= rendement tel que mesuré (kg/ha) -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
= humidité mesurée (%) -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mrow><mi>s</mi><mi>t</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">H_{std}</annotation></semantics></math>
= humidité standard de la culture (%)</p>
<div class="section level4">
<h4 id="humidités-standards-par-culture">Humidités standards par culture<a class="anchor" aria-label="anchor" href="#humidit%C3%A9s-standards-par-culture"></a>
</h4>
<table class="table">
<thead><tr class="header">
<th>Culture</th>
<th>Humidité standard</th>
<th>Base</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Maïs</td>
<td>15.5%</td>
<td>56 lbs/bu</td>
</tr>
<tr class="even">
<td>Soja</td>
<td>13.0%</td>
<td>60 lbs/bu</td>
</tr>
<tr class="odd">
<td>Blé</td>
<td>13.5%</td>
<td>60 lbs/bu</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="définition-de-la-plage-acceptable">Définition de la plage acceptable<a class="anchor" aria-label="anchor" href="#d%C3%A9finition-de-la-plage-acceptable"></a>
</h3>
<div class="section level4">
<h4 id="méthode-1-seuils-fixes">Méthode 1: Seuils fixes<a class="anchor" aria-label="anchor" href="#m%C3%A9thode-1-seuils-fixes"></a>
</h4>
<p>Basée sur les limites physiologiques et commerciales :</p>
<table class="table">
<thead><tr class="header">
<th>Culture</th>
<th>Minimum</th>
<th>Maximum</th>
<th>Remarques</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Maïs</td>
<td>10%</td>
<td>40%</td>
<td>Au-dessus de 40% = grain vert</td>
</tr>
<tr class="even">
<td>Soja</td>
<td>8%</td>
<td>20%</td>
<td>Au-dessus de 20% = fermentation</td>
</tr>
<tr class="odd">
<td>Blé</td>
<td>10%</td>
<td>25%</td>
<td>Au-dessus de 25% = difficultés de battage</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="méthode-2-calcul-automatique-méthode-ayce">Méthode 2: Calcul automatique (méthode AYCE)<a class="anchor" aria-label="anchor" href="#m%C3%A9thode-2-calcul-automatique-m%C3%A9thode-ayce"></a>
</h4>
<p>Basée sur la distribution statistique de l’humidité dans le champ
:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo>=</mo><mover><mi>H</mi><mo accent="true">‾</mo></mover><mo>−</mo><msub><mi>n</mi><mrow><mi>s</mi><mi>t</mi><mi>d</mi></mrow></msub><mo>×</mo><msub><mi>σ</mi><mi>H</mi></msub></mrow><annotation encoding="application/x-tex">H_{min} = \bar{H} - n_{std} \times \sigma_H</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>=</mo><mover><mi>H</mi><mo accent="true">‾</mo></mover><mo>+</mo><msub><mi>n</mi><mrow><mi>s</mi><mi>t</mi><mi>d</mi></mrow></msub><mo>×</mo><msub><mi>σ</mi><mi>H</mi></msub></mrow><annotation encoding="application/x-tex">H_{max} = \bar{H} + n_{std} \times \sigma_H</annotation></semantics></math></p>
<p>Où : -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>H</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{H}</annotation></semantics></math>
= humidité moyenne -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>H</mi></msub><annotation encoding="application/x-tex">\sigma_H</annotation></semantics></math>
= écart-type de l’humidité -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>s</mi><mi>t</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">n_{std}</annotation></semantics></math>
= nombre d’écarts-types (défaut: 3)</p>
</div>
</div>
<div class="section level3">
<h3 id="règle-de-décision">Règle de décision<a class="anchor" aria-label="anchor" href="#r%C3%A8gle-de-d%C3%A9cision"></a>
</h3>
<p>Un point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
est conservé si :</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo>≤</mo><msub><mi>H</mi><mi>i</mi></msub><mo>≤</mo><msub><mi>H</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_{min} \leq H_i \leq H_{max}</annotation></semantics></math></p>
<p>Et si
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_i &gt; 0</annotation></semantics></math>
(humidité valide).</p>
</div>
</div>
<div class="section level2">
<h2 id="implémentation">Implémentation<a class="anchor" aria-label="anchor" href="#impl%C3%A9mentation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cedricbouffard/yieldcleanr" class="external-link">yieldcleanr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Charger les données</span></span>
<span><span class="va">file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sample1.txt"</span>, package <span class="op">=</span> <span class="st">"yieldcleanr"</span><span class="op">)</span></span>
<span><span class="va">data_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_yield_data.html">read_yield_data</a></span><span class="op">(</span><span class="va">file_path</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Réduire la taille pour accélérer le build (échantillon représentatif)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_raw</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">3000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data_raw</span> <span class="op">&lt;-</span> <span class="va">data_raw</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_raw</span><span class="op">)</span>, <span class="fl">3000</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Préparation</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/latlon_to_utm.html">latlon_to_utm</a></span><span class="op">(</span><span class="va">data_raw</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/convert_flow_to_yield.html">convert_flow_to_yield</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"=== Filtre d'humidité ===\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; === Filtre d'humidité ===</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Points avant filtrage:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Points avant filtrage: 2998</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Humidité (%):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Humidité (%):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Moyenne:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Moisture</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Moyenne: 9.6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Min:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Moisture</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Min: 0.1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Max:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Moisture</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Max: 11.9</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Écart-type:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Moisture</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Écart-type: 0.6</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calcul-automatique-des-seuils">Calcul automatique des seuils<a class="anchor" aria-label="anchor" href="#calcul-automatique-des-seuils"></a>
</h2>
<div class="section level3">
<h3 id="méthode-statistique">Méthode statistique<a class="anchor" aria-label="anchor" href="#m%C3%A9thode-statistique"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculer les seuils automatiques</span></span>
<span><span class="va">n_std</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">mean_moisture</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Moisture</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">sd_moisture</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Moisture</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">min_moisture_auto</span> <span class="op">&lt;-</span> <span class="va">mean_moisture</span> <span class="op">-</span> <span class="va">n_std</span> <span class="op">*</span> <span class="va">sd_moisture</span></span>
<span><span class="va">max_moisture_auto</span> <span class="op">&lt;-</span> <span class="va">mean_moisture</span> <span class="op">+</span> <span class="va">n_std</span> <span class="op">*</span> <span class="va">sd_moisture</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n=== Seuils calculés automatiquement ===\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Seuils calculés automatiquement ===</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Moyenne:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mean_moisture</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Moyenne: 9.6 %</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Écart-type:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sd_moisture</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Écart-type: 0.6 %</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Plage (moyenne ± 3 SD):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Plage (moyenne ± 3 SD):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Minimum:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">min_moisture_auto</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Minimum: 7.8 %</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Maximum:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">max_moisture_auto</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Maximum: 11.4 %</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="distribution-de-lhumidité">Distribution de l’humidité<a class="anchor" aria-label="anchor" href="#distribution-de-lhumidit%C3%A9"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Distribution de l'humidité</span></span>
<span><span class="va">moistures</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">Moisture</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Moisture</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>moisture <span class="op">=</span> <span class="va">moistures</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">moisture</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, fill <span class="op">=</span> <span class="st">"#3498db"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">min_moisture_auto</span>, color <span class="op">=</span> <span class="st">"#e74c3c"</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">max_moisture_auto</span>, color <span class="op">=</span> <span class="st">"#e74c3c"</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">mean_moisture</span>, color <span class="op">=</span> <span class="st">"#27ae60"</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"solid"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">min_moisture_auto</span>, y <span class="op">=</span> <span class="cn">Inf</span>, </span>
<span>           label <span class="op">=</span> <span class="st">"Min"</span>, vjust <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"#e74c3c"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">max_moisture_auto</span>, y <span class="op">=</span> <span class="cn">Inf</span>, </span>
<span>           label <span class="op">=</span> <span class="st">"Max"</span>, vjust <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"#e74c3c"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="va">mean_moisture</span>, y <span class="op">=</span> <span class="cn">Inf</span>, </span>
<span>           label <span class="op">=</span> <span class="st">"Moyenne"</span>, vjust <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"#27ae60"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution de l'humidité"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Seuils automatiques (moyenne ± 3 SD)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Humidité (%)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Fréquence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span></span></code></pre></div>
<p><img src="filtre-humidite_files/figure-html/moisture-dist-1.png" class="r-plt" alt="" width="1152"></p>
</div>
</div>
<div class="section level2">
<h2 id="application-du-filtre">Application du filtre<a class="anchor" aria-label="anchor" href="#application-du-filtre"></a>
</h2>
<div class="section level3">
<h3 id="filtrage-automatique">Filtrage automatique<a class="anchor" aria-label="anchor" href="#filtrage-automatique"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n=== Application du filtre automatique ===\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Application du filtre automatique ===</span></span>
<span></span>
<span><span class="co"># Appliquer le filtre</span></span>
<span><span class="va">data_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_data.html">filter_data</a></span><span class="op">(</span><span class="va">data</span>, type <span class="op">=</span> <span class="st">"moisture"</span>, n_std <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Points après filtrage:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_filtered</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Points après filtrage: 2957</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Points retirés:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_filtered</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Points retirés: 41</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Taux de rétention:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_filtered</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Taux de rétention: 98.6 %</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="filtrage-manuel">Filtrage manuel<a class="anchor" aria-label="anchor" href="#filtrage-manuel"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n=== Filtrage avec seuils manuels ===\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Filtrage avec seuils manuels ===</span></span>
<span></span>
<span><span class="co"># Seuils pour soja</span></span>
<span><span class="va">min_manual</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">max_manual</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Seuils manuels (soja):"</span>, <span class="va">min_manual</span>, <span class="st">"-"</span>, <span class="va">max_manual</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Seuils manuels (soja): 8 - 20 %</span></span>
<span></span>
<span><span class="va">data_manual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_data.html">filter_data</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                           type <span class="op">=</span> <span class="st">"moisture"</span>,</span>
<span>                           min_moisture <span class="op">=</span> <span class="va">min_manual</span>,</span>
<span>                           max_moisture <span class="op">=</span> <span class="va">max_manual</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Points après filtrage manuel:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_manual</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Points après filtrage manuel: 2994</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Points retirés:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_manual</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Points retirés: 4</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="visualisation-des-points-éliminés">Visualisation des points éliminés<a class="anchor" aria-label="anchor" href="#visualisation-des-points-%C3%A9limin%C3%A9s"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identifier les points éliminés</span></span>
<span><span class="va">removed</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Moisture</span> <span class="op">&lt;</span> <span class="va">min_moisture_auto</span> <span class="op">|</span> </span>
<span>         <span class="va">Moisture</span> <span class="op">&gt;</span> <span class="va">max_moisture_auto</span> <span class="op">|</span></span>
<span>         <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">Moisture</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nPoints éliminés par humidité:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">removed</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Points éliminés par humidité: 41</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">removed</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sf_removed</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">removed</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Longitude"</span>, <span class="st">"Latitude"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span>  <span class="va">sf_all</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">data</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Longitude"</span>, <span class="st">"Latitude"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sf_all</span><span class="op">[</span><span class="st">"Moisture"</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"Tous les points (humidité)"</span>, </span>
<span>       pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">0.3</span>, breaks <span class="op">=</span> <span class="st">"jenks"</span>, key.pos <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sf_removed</span><span class="op">[</span><span class="st">"Moisture"</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"Points éliminés (humidité)"</span>, </span>
<span>       pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, breaks <span class="op">=</span> <span class="st">"jenks"</span>, key.pos <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="filtre-humidite_files/figure-html/removed-moisture-1.png" class="r-plt" alt="" width="1344"><img src="filtre-humidite_files/figure-html/removed-moisture-2.png" class="r-plt" alt="" width="1344"></p>
</div>
<div class="section level2">
<h2 id="analyse-temporelle-de-lhumidité">Analyse temporelle de l’humidité<a class="anchor" aria-label="anchor" href="#analyse-temporelle-de-lhumidit%C3%A9"></a>
</h2>
<div class="section level3">
<h3 id="variation-au-cours-de-la-récolte">Variation au cours de la récolte<a class="anchor" aria-label="anchor" href="#variation-au-cours-de-la-r%C3%A9colte"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Trier par temps et échantillonner pour la ligne de tendance (LOESS est lent avec beaucoup de points)</span></span>
<span><span class="va">data_time</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">GPS_Time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>time_normalized <span class="op">=</span> <span class="op">(</span><span class="va">GPS_Time</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">GPS_Time</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">3600</span><span class="op">)</span>  <span class="co"># En heures</span></span>
<span></span>
<span><span class="co"># Échantillon pour la ligne de tendance (max 5000 points)</span></span>
<span><span class="va">n_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_time</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">n_points</span> <span class="op">&gt;</span> <span class="fl">5000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span>  <span class="va">data_sample</span> <span class="op">&lt;-</span> <span class="va">data_time</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">n_points</span>, <span class="fl">5000</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">data_sample</span> <span class="op">&lt;-</span> <span class="va">data_time</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Graphique temporel</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_time</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_normalized</span>, y <span class="op">=</span> <span class="va">Moisture</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span>, size <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"#3498db"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_sample</span>, method <span class="op">=</span> <span class="st">"loess"</span>, color <span class="op">=</span> <span class="st">"#e74c3c"</span>, se <span class="op">=</span> <span class="cn">TRUE</span>, span <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">min_moisture_auto</span>, color <span class="op">=</span> <span class="st">"#27ae60"</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">max_moisture_auto</span>, color <span class="op">=</span> <span class="st">"#27ae60"</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Évolution de l'humidité au cours du temps"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Points hors plage seront éliminés"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Temps (heures depuis le début)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Humidité (%)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span></span></code></pre></div>
<p><img src="filtre-humidite_files/figure-html/moisture-temporal-1.png" class="r-plt" alt="" width="1152"></p>
</div>
</div>
<div class="section level2">
<h2 id="impact-sur-le-rendement">Impact sur le rendement<a class="anchor" aria-label="anchor" href="#impact-sur-le-rendement"></a>
</h2>
<div class="section level3">
<h3 id="conversion-humide-sec">Conversion humide → sec<a class="anchor" aria-label="anchor" href="#conversion-humide-sec"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n=== Impact de l'humidité sur le rendement ===\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Impact de l'humidité sur le rendement ===</span></span>
<span></span>
<span><span class="co"># Calculer le rendement sec</span></span>
<span><span class="va">humidite_standard</span> <span class="op">&lt;-</span> <span class="fl">13</span>  <span class="co"># Pour soja</span></span>
<span></span>
<span><span class="co"># Avant filtrage</span></span>
<span><span class="va">rendement_humide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Yield_kg_ha</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">humidite_moyenne</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Moisture</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">rendement_sec_brut</span> <span class="op">&lt;-</span> <span class="va">rendement_humide</span> <span class="op">*</span> <span class="op">(</span><span class="fl">100</span> <span class="op">-</span> <span class="va">humidite_moyenne</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">100</span> <span class="op">-</span> <span class="va">humidite_standard</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Avant filtrage:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Avant filtrage:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Rendement humide moyen:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rendement_humide</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"kg/ha\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Rendement humide moyen: 3523.5 kg/ha</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Humidité moyenne:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">humidite_moyenne</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Humidité moyenne: 9.6 %</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Rendement sec équivalent:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rendement_sec_brut</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"kg/ha\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Rendement sec équivalent: 3660.6 kg/ha</span></span>
<span></span>
<span><span class="co"># Après filtrage</span></span>
<span><span class="va">rendement_humide_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data_filtered</span><span class="op">$</span><span class="va">Yield_kg_ha</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">humidite_moyenne_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data_filtered</span><span class="op">$</span><span class="va">Moisture</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">rendement_sec_filt</span> <span class="op">&lt;-</span> <span class="va">rendement_humide_filt</span> <span class="op">*</span> <span class="op">(</span><span class="fl">100</span> <span class="op">-</span> <span class="va">humidite_moyenne_filt</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">100</span> <span class="op">-</span> <span class="va">humidite_standard</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nAprès filtrage:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Après filtrage:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Rendement humide moyen:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rendement_humide_filt</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"kg/ha\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Rendement humide moyen: 3524.3 kg/ha</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Humidité moyenne:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">humidite_moyenne_filt</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Humidité moyenne: 9.6 %</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Rendement sec équivalent:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rendement_sec_filt</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"kg/ha\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Rendement sec équivalent: 3661.9 kg/ha</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nDifférence:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rendement_sec_filt</span> <span class="op">-</span> <span class="va">rendement_sec_brut</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"kg/ha\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Différence: 1.3 kg/ha</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="paramètres-recommandés">Paramètres recommandés<a class="anchor" aria-label="anchor" href="#param%C3%A8tres-recommand%C3%A9s"></a>
</h2>
<div class="section level3">
<h3 id="par-culture">Par culture<a class="anchor" aria-label="anchor" href="#par-culture"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Culture</th>
<th>Humidité standard</th>
<th>Plage acceptable</th>
<th>n_std recommandé</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Maïs</td>
<td>15.5%</td>
<td>10-40%</td>
<td>3</td>
</tr>
<tr class="even">
<td>Soja</td>
<td>13.0%</td>
<td>8-20%</td>
<td>3</td>
</tr>
<tr class="odd">
<td>Blé</td>
<td>13.5%</td>
<td>10-25%</td>
<td>3</td>
</tr>
<tr class="even">
<td>Orge</td>
<td>14.5%</td>
<td>10-25%</td>
<td>3</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="paramètres-de-la-fonction">Paramètres de la fonction<a class="anchor" aria-label="anchor" href="#param%C3%A8tres-de-la-fonction"></a>
</h3>
<table class="table">
<caption>Paramètres du filtre d’humidité</caption>
<thead><tr class="header">
<th align="left">Paramètre</th>
<th align="left">Description</th>
<th align="left">Défaut</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">type</td>
<td align="left">Type de filtre (‘moisture’)</td>
<td align="left">‘moisture’</td>
</tr>
<tr class="even">
<td align="left">min_value</td>
<td align="left">Humidité minimum (%)</td>
<td align="left">auto</td>
</tr>
<tr class="odd">
<td align="left">max_value</td>
<td align="left">Humidité maximum (%)</td>
<td align="left">auto</td>
</tr>
<tr class="even">
<td align="left">n_std</td>
<td align="left">Nombre d’écarts-types pour calcul auto</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">moisture_column</td>
<td align="left">Nom de la colonne d’humidité</td>
<td align="left">‘Moisture’</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="cas-particuliers">Cas particuliers<a class="anchor" aria-label="anchor" href="#cas-particuliers"></a>
</h2>
<div class="section level3">
<h3 id="humidité-nulle-ou-manquante">1. Humidité nulle ou manquante<a class="anchor" aria-label="anchor" href="#humidit%C3%A9-nulle-ou-manquante"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Points avec humidité nulle ou manquante</span></span>
<span><span class="va">zero_moist</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Moisture</span> <span class="op">&lt;=</span> <span class="fl">0</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Moisture</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Points avec humidité ≤ 0 ou manquante:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">zero_moist</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Points avec humidité ≤ 0 ou manquante: 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Ces points sont généralement éliminés car l'humidité est requise\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Ces points sont généralement éliminés car l'humidité est requise</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"pour la conversion rendement humide → sec.\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; pour la conversion rendement humide → sec.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dérive-dhumidité-en-fin-de-journée">2. Dérive d’humidité en fin de journée<a class="anchor" aria-label="anchor" href="#d%C3%A9rive-dhumidit%C3%A9-en-fin-de-journ%C3%A9e"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simuler une dérive d'humidité</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">temps</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span></span>
<span><span class="va">humidite_normale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">12</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">humidite_derfive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">humidite_normale</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">80</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">18</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_drift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  temps <span class="op">=</span> <span class="va">temps</span>,</span>
<span>  humidite <span class="op">=</span> <span class="va">humidite_derfive</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Normal"</span>, <span class="fl">80</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Dérive"</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_drift</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temps</span>, y <span class="op">=</span> <span class="va">humidite</span>, color <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">15</span>, color <span class="op">=</span> <span class="st">"#e74c3c"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">90</span>, y <span class="op">=</span> <span class="fl">16</span>, label <span class="op">=</span> <span class="st">"Seuil max"</span>, color <span class="op">=</span> <span class="st">"#e74c3c"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Dérive d'humidité en fin de journée"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Augmentation due à la rosée ou changement de conditions"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Temps"</span>, y <span class="op">=</span> <span class="st">"Humidité (%)"</span>, color <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span></span></code></pre></div>
<p><img src="filtre-humidite_files/figure-html/moisture-drift-1.png" class="r-plt" alt="" width="960"></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Le filtre d’humidité est essentiel pour : 1. <strong>Assurer la
qualité de la conversion</strong> humide → sec 2. <strong>Éliminer les
points avec capteur d’humidité défectueux</strong> 3. <strong>Corriger
les dérives temporelles</strong> de l’humidité 4. <strong>Standardiser
les rendements</strong> à une humidité de référence</p>
<p><strong>Points clés :</strong> - L’humidité affecte directement le
calcul du rendement sec - Les seuils peuvent être calculés
automatiquement (±3 SD) ou définis manuellement - Une humidité anormale
indique souvent un problème de capteur - La dérive temporelle est
courante en fin de journée</p>
<p><strong>Recommandation</strong> : Toujours vérifier la distribution
de l’humidité avant filtrage. Une humidité moyenne trop élevée (&gt; 25%
pour le maïs) peut indiquer des conditions de récolte défavorables.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cedric Bouffard.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
